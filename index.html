<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Circuito CHIP5 6.1</title>
<style>
body{font-family:Arial;background:#111;color:#fff;padding:20px}
h1{text-align:center;color:#FFD700}
table{width:100%;border-collapse:collapse;margin-top:20px;background:#1c1c1c}
th,td{border:1px solid #333;padding:8px;text-align:center}
th{background:#FFD700;color:#000}
.top1{background:#6b5e00}
.top2{background:#444}
.top3{background:#5a3d00}
</style>
</head>
<body>

<h1>üèÜ Circuito CHIP5 2026</h1>

<h3>Importar Planilha CSV</h3>
<input type="file" id="file">

<div id="resultado"></div>

<script>

let atletas=[];

function pontos(pos){
if(pos==1)return 100;
if(pos==2)return 80;
if(pos==3)return 70;
if(pos==4)return 60;
if(pos==5)return 50;
if(pos==6)return 45;
if(pos==7)return 40;
if(pos==8)return 35;
if(pos==9)return 30;
if(pos==10)return 25;
return 10;
}

document.getElementById("file").addEventListener("change",function(e){

let reader=new FileReader();

reader.onload=function(){

let texto=reader.result;

let linhas=texto.split("\n");
linhas.shift();

linhas.forEach(linha=>{

if(!linha.trim()) return;

let separador = linha.includes(";") ? ";" : ",";

let c=linha.split(separador);

if(c.length<6) return;

let nome=c[0].trim();
let sexo=c[1].trim();
let dist=c[2].trim();
let cat=c[3].trim();
let etapa=parseInt(c[4])-1;
let pos=parseInt(c[5]);

let atleta=atletas.find(a=>a.nome===nome);

if(!atleta){
atleta={nome,sexo,dist,cat,p:[0,0,0,0,0,0,0,0]};
atletas.push(atleta);
}

atleta.p[etapa]=pontos(pos);

});

gerar();

};

reader.readAsText(e.target.files[0]);

});

function gerar(){

let div=document.getElementById("resultado");
div.innerHTML="";

atletas.forEach(a=>{
a.total=a.p.reduce((s,v)=>s+v,0);
let menor=Math.min(...a.p);
a.final=a.total-menor;
});

atletas.sort((a,b)=>b.final-a.final);

let tabela="<table><tr><th>Pos</th><th>Nome</th><th>Dist</th><th>Categoria</th><th>Total c/ Descarte</th></tr>";

atletas.forEach((a,i)=>{

let classe="";
if(i==0)classe="top1";
if(i==1)classe="top2";
if(i==2)classe="top3";

tabela+=`<tr class="${classe}">
<td>${i+1}</td>
<td>${a.nome}</td>
<td>${a.dist}</td>
<td>${a.cat}</td>
<td>${a.final}</td>
</tr>`;
});

tabela+="</table>";

div.innerHTML=tabela;

}

</script>

</body>
</html>
